{% extends 'main/layout.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

<div class="col-sm-12 p-4">
    <div class="breadcrumb-holder">
        <div class="container-fluid">
            <ul class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Varanda</a></li>
                <li class="breadcrumb-item active">{{title}}</li>
            </ul>
        </div>
    </div>
    <section>
        <div class="container-fluid">
            {% if messages %}
                {% for message in messages %} 
                    <div id="divmessage" class="alert alert-{{ message.tags }} alert-dismissable">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                        {{message}}
                    </div>
                {% endfor %}
            {% endif %}
            <div class="row mt-3">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between text-center">
                            <div class="text-center">
                                <h3>{{title}}</h3>
                            </div>
                            <div class="d-flex justify-content-end">
                                <!-- <div class="text-center mr-2">
                                    <a href="{% url 'create_leave' %}" class="btn btn-sm btn-info" title="Adiciona dados"><i class="fa fa-plus"></i> Adiciona </a>
                                </div>
                                <div class="text-center mr-2">
                                    <a href="#" class="btn btn-sm btn-info" title="Adiciona dados"><i class="fa fa-upload"></i> Import Dados </a>
                                </div> -->
                                <div class="text-center">
                                    <a href="{% url 'pdf_leave' %}" target="_blank" class="btn btn-sm btn-info" title="Print Data"><i class="fa fa-print"></i> Print Pdf</a>
                                    <a href="{% url 'csv_leave' %}" target="_blank" class="btn btn-sm btn-info" title="Print Data"><i class="fa fa-print"></i> Print Csv</a>
                                </div>
                            </div>
                        </div>

                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="example" class="table table-hover table-bordered" width="100%">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>No Id</th>
                                            <th>Nome Completo</th>
                                            <th>Tipo de Licença</th>
                                            <th>Data de Início</th>
                                            <th>Data de Término</th>
                                            <th>Status</th>
                                            <th>Motivo</th>
                                            <!-- <th>Acção</th> -->
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for data in dadus %}
                                            <tr>
                                                <th scope="row">{{ forloop.counter }}</th>
                                                <td>{{ data.employee.nu_id }}</td>
                                                <td><a href="{% url 'detail_leave' data.id %}" style="color: #2b90d9;">{{ data.employee }}</a></td>
                                                <td>{{ data.leave_type }}</td>
                                                <td>{{ data.start_date }}</td>
                                                <td>{{ data.end_date }}</td>
                                                <td>{{ data.status }}</td>
                                                <td>{{ data.reason }}</td>
                                                <!-- <td>
                                                    <div class="d-flex">
                                                        <div class="flex-fill"><a href="{% url 'update_leave' data.id %}" class="btn btn-sm" style="color: #2b90d9;" title="Atualiza Dados"><i class="fa fa-pencil" style="color: #2b90d9;"></i></a></div>
                                                        <div class="flex-fill"><button type="button" class="btn btn-sm btn-danger" data-toggle="modal" data-target="#delete-{{ data.id }}" style="text-decoration: none"><i class="fa fa-remove"></i></button></div>
                                                    </div>
                                                    {% if data.status == 'Leave Over' and not data.archived %}
                                                        <form action="{% url 'archive_leave' data.id %}" method="post" style="margin-top: 5px;">
                                                            {% csrf_token %}
                                                            <button type="submit" class="btn btn-sm btn-warning">Archive</button>
                                                        </form>
                                                    {% endif %}
                                                </td> -->
                                            </tr>

                                            <div class="modal fade" id="delete-{{ data.id }}">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Apagar dados</h4>
                                                            <button type="button" class="close" data-dismiss="modal">X</button>
                                                        </div>
                                                        <div class="modal-body">
                                                            Deseja excluir dados nomeado : {{ data.employee | upper }}?
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Não</button>
                                                            <a href="{% url 'delete_leave' data.id %}" class="btn btn-info">Sim</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>

<script>
    $(document).ready(function() {
        $('#example').DataTable();
    });
</script>

{% endblock %}
